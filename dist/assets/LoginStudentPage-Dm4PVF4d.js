import{r as e,u as S,j as s,L as E,s as l}from"./index-Do9N5Bdr.js";import{M as L}from"./Modal-C0JTwID5.js";import{E as C}from"./eye-off-CzSuKnRE.js";import{E as O}from"./eye-Cn1LezQ_.js";const I=()=>{const[i,j]=e.useState(""),[d,w]=e.useState(""),[r,b]=e.useState(!1),[c,t]=e.useState(!1),[u,m]=e.useState(""),[v,o]=e.useState(!1),[n,p]=e.useState({title:"",message:"",button:null}),h=S(),N=async a=>{a.preventDefault(),m(""),t(!0);const{data:{user:g}={},error:f}=await l.auth.signInWithPassword({email:i,password:d});if(f){m(f.message),t(!1);return}if(g){const{data:x,error:y}=await l.from("profiles").select("role").eq("id",g.id).single();y||!x?(p({title:"Login Error",message:"Could not verify user role. Please try again."}),o(!0),await l.auth.signOut(),t(!1)):x.role!=="student"?(p({title:"Incorrect Account Type",message:"This is not a student account.",button:s.jsx("button",{className:"ls-btn",onClick:()=>h("/login"),children:"Go to Login Chooser"})}),o(!0),await l.auth.signOut(),t(!1)):(h("/student-panel"),t(!1))}else t(!1)};return s.jsxs("div",{className:"ls-auth-page",children:[s.jsxs(L,{isOpen:v,onClose:()=>o(!1),className:"ls-modal",children:[s.jsx("h2",{children:n.title}),s.jsx("p",{children:n.message}),s.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"1rem"},children:[n.button,s.jsx("button",{className:"ls-btn-secondary",onClick:()=>o(!1),children:"OK"})]})]}),s.jsx("div",{className:"ls-auth-form-container",children:s.jsxs("form",{className:"ls-auth-form",onSubmit:N,children:[s.jsx("h1",{children:"Student Login"}),s.jsx("p",{className:"ls-auth-form-description",children:"Log in to your Student account."}),u&&s.jsx("p",{className:"ls-error-message",children:u}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"email",children:"Email"}),s.jsx("input",{type:"email",id:"email",value:i,onChange:a=>j(a.target.value),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"password",children:"Password"}),s.jsxs("div",{className:"ls-password-input-wrapper",children:[s.jsx("input",{type:r?"text":"password",id:"password",value:d,onChange:a=>w(a.target.value),required:!0}),s.jsx("button",{type:"button",onClick:()=>b(!r),className:"ls-password-toggle-btn","aria-label":r?"Hide password":"Show password",children:r?s.jsx(C,{size:20}):s.jsx(O,{size:20})})]})]}),s.jsx("button",{type:"submit",className:"ls-btn",disabled:c,children:c?"Logging in...":"Login"}),s.jsxs("p",{className:"ls-auth-switch",children:["Don't have an account? ",s.jsx(E,{to:"/register",children:"Register"})]})]})})]})};export{I as default};
