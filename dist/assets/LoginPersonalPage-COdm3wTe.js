import{r as s,u as E,j as e,L,s as l}from"./index-Do9N5Bdr.js";import{M as P}from"./Modal-C0JTwID5.js";import{E as S}from"./eye-off-CzSuKnRE.js";import{E as C}from"./eye-Cn1LezQ_.js";const q=()=>{const[i,j]=s.useState(""),[c,w]=s.useState(""),[r,b]=s.useState(!1),[d,a]=s.useState(!1),[u,p]=s.useState(""),[v,o]=s.useState(!1),[n,m]=s.useState({title:"",message:"",button:null}),h=E(),N=async t=>{t.preventDefault(),p(""),a(!0);const{data:{user:g}={},error:f}=await l.auth.signInWithPassword({email:i,password:c});if(f){p(f.message),a(!1);return}if(g){const{data:x,error:y}=await l.from("profiles").select("role").eq("id",g.id).single();y||!x?(m({title:"Login Error",message:"Could not verify user role. Please try again."}),o(!0),await l.auth.signOut(),a(!1)):x.role==="teacher"?(m({title:"Incorrect Account Type",message:"This is a teacher account. Please use the teacher login page.",button:e.jsx("button",{className:"lp-btn",onClick:()=>h("/login/teacher"),children:"Go to Teacher Login"})}),o(!0),await l.auth.signOut(),a(!1)):(h("/account"),a(!1))}else a(!1)};return e.jsxs("div",{className:"lp-auth-page",children:[e.jsxs(P,{isOpen:v,onClose:()=>o(!1),className:"lp-modal",children:[e.jsx("h2",{children:n.title}),e.jsx("p",{children:n.message}),e.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"1rem"},children:[n.button,e.jsx("button",{className:"lp-btn-secondary",onClick:()=>o(!1),children:"OK"})]})]}),e.jsx("div",{className:"lp-auth-form-container",children:e.jsxs("form",{className:"lp-auth-form",onSubmit:N,children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"lp-auth-form-description",children:"Log in to your Personal account."}),u&&e.jsx("p",{className:"lp-error-message",children:u}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",id:"email",value:i,onChange:t=>j(t.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"lp-password-input-wrapper",children:[e.jsx("input",{type:r?"text":"password",id:"password",value:c,onChange:t=>w(t.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>b(!r),className:"lp-password-toggle-btn","aria-label":r?"Hide password":"Show password",children:r?e.jsx(S,{size:20}):e.jsx(C,{size:20})})]})]}),e.jsx("button",{type:"submit",className:"lp-btn",disabled:d,children:d?"Logging in...":"Login"}),e.jsxs("p",{className:"lp-auth-switch",children:["Don't have an account? ",e.jsx(L,{to:"/register",children:"Register"})]})]})})]})};export{q as default};
