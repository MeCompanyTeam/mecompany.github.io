import{a as v,u as C,r,j as s,L as S,s as f}from"./index-Do9N5Bdr.js";import{P as E}from"./PasswordStrengthMeter-BDx7gZ8o.js";import{z as k}from"./main-B-2c47NO.js";/* empty css                 */import{E as z}from"./eye-off-CzSuKnRE.js";import{E as q}from"./eye-Cn1LezQ_.js";const A=()=>{const{user:j}=v(),N=C(),[i,d]=r.useState(""),[a,c]=r.useState(""),[l,u]=r.useState(""),[o,P]=r.useState(!1),[m,n]=r.useState(!1),[w,t]=r.useState(""),[p,h]=r.useState(""),b=async e=>{if(e.preventDefault(),t(""),h(""),a!==l){t("New passwords do not match.");return}const g=k(a);if(g.score<3){t(`New password is too weak. ${g.feedback.suggestions.join(" ")}`);return}n(!0);const{error:y}=await f.auth.signInWithPassword({email:j.email,password:i});if(y){t("Your current password is not correct."),n(!1);return}const{error:x}=await f.auth.updateUser({password:a});x?t(x.message):(h("Your password has been changed successfully."),d(""),c(""),u("")),n(!1)};return s.jsxs("div",{children:[s.jsx(S,{to:"/account/settings/security",className:"btn-secondary",style:{marginBottom:"2rem",display:"inline-block"},children:"â† Back to Security"}),s.jsx("h1",{children:"Change Password"}),s.jsx("div",{className:"auth-form-container",style:{margin:"2rem 0"},children:s.jsxs("form",{className:"auth-form",onSubmit:b,children:[w&&s.jsx("p",{className:"error-message",children:w}),p&&s.jsx("p",{className:"success-message",children:p}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"currentPassword",children:"Current Password"}),s.jsx("input",{id:"currentPassword",type:"password",value:i,onChange:e=>d(e.target.value),required:!0})]}),s.jsx("hr",{}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"newPassword",children:"New Password"}),s.jsxs("div",{className:"password-input-wrapper",children:[s.jsx("input",{id:"newPassword",type:o?"text":"password",value:a,onChange:e=>c(e.target.value),required:!0}),s.jsx("button",{type:"button",onClick:()=>P(!o),className:"password-toggle-btn",children:o?s.jsx(z,{size:20}):s.jsx(q,{size:20})})]}),s.jsx(E,{password:a})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"confirmNewPassword",children:"Confirm New Password"}),s.jsx("input",{id:"confirmNewPassword",type:"password",value:l,onChange:e=>u(e.target.value),required:!0})]}),s.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"2rem"},children:[s.jsx("button",{type:"submit",className:"btn",disabled:m,children:m?"Changing...":"Change Password"}),s.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>N("/account/settings/security"),children:"Cancel"})]})]})})]})};export{A as default};
