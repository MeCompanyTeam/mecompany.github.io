import{c as v,a as N,r as e,j as s,s as c}from"./index-Do9N5Bdr.js";import{U as y}from"./users-BCv83-ox.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],I=v("user",_),q=()=>{const{profile:t,loading:l}=N(),[u,x]=e.useState(null),[n,f]=e.useState([]),[j,p]=e.useState(0),[g,a]=e.useState(!0),[h,m]=e.useState(null);return e.useEffect(()=>{(async()=>{if(!t||l){a(!1);return}if(!t.institution_id){m("You are not assigned to any institution."),a(!1);return}try{const[i,d,o]=await Promise.all([c.from("institutions").select("*").eq("id",t.institution_id).single(),c.from("profiles").select("id, first_name, last_name").eq("institution_id",t.institution_id).eq("role","teacher"),c.from("profiles").select("id",{count:"exact",head:!0}).eq("institution_id",t.institution_id).eq("role","student")]);if(i.error)throw i.error;if(x(i.data),d.error)throw d.error;if(f(d.data),o.error)throw o.error;p(o.count)}catch(i){console.error("Error fetching institution data:",i.message),m("Failed to load institution details.")}finally{a(!1)}})()},[t,l]),g?s.jsx("div",{children:"Loading institution details..."}):h?s.jsx("div",{className:"error-message",children:h}):u?s.jsxs("div",{children:[s.jsx("h1",{children:u.name}),s.jsx("p",{children:"Details about your assigned institution."}),s.jsxs("div",{className:"dashboard-grid",style:{marginTop:"2rem"},children:[s.jsxs("div",{className:"dashboard-card",children:[s.jsxs("div",{className:"card-header",children:[s.jsx(I,{size:24}),s.jsx("h2",{children:"Teachers"})]}),s.jsx("p",{className:"card-main-stat",children:n.length}),s.jsx("p",{children:"Currently assigned to this institution."})]}),s.jsxs("div",{className:"dashboard-card",children:[s.jsxs("div",{className:"card-header",children:[s.jsx(y,{size:24}),s.jsx("h2",{children:"Students"})]}),s.jsx("p",{className:"card-main-stat",children:j}),s.jsx("p",{children:"Currently enrolled in this institution."})]}),s.jsxs("div",{className:"dashboard-card wide-card",children:[s.jsx("div",{className:"card-header",children:s.jsx("h2",{children:"Teacher Roster"})}),n.length>0?s.jsx("ul",{className:"recent-list",children:n.map(r=>s.jsx("li",{children:s.jsxs("span",{children:[r.first_name," ",r.last_name]})},r.id))}):s.jsx("p",{children:"No teachers found for this institution."})]})]})]}):s.jsx("div",{children:"No institution details available."})};export{q as default};
