import{a as g,r as d,j as e,L as n,s as m}from"./index-Do9N5Bdr.js";import{U as y}from"./users-BCv83-ox.js";import{B as S}from"./book-open-D11F-aLU.js";import{C as u}from"./circle-plus-C4i9EsG5.js";const k=()=>{const{user:a,profile:s,loading:i}=g(),[x,j]=d.useState(0),[l,f]=d.useState([]),[p,o]=d.useState(!0),[h,b]=d.useState(null);return d.useEffect(()=>{(async()=>{if(!a||!s||i){o(!1);return}try{const[r,c]=await Promise.all([m.from("teacher_students").select("id",{count:"exact",head:!0}).eq("teacher_id",s.id),m.from("teacher_students").select("student:profiles!student_id(id, first_name, last_name)").eq("teacher_id",s.id).order("created_at",{ascending:!1}).limit(5)]);if(r.error)throw r.error;if(j(r.count),c.error)throw c.error;const N=c.data.map(v=>v.student).filter(Boolean);f(N)}catch(r){console.error("Error fetching dashboard data:",r.message),b("Failed to load dashboard data.")}finally{o(!1)}})()},[a,s,i]),p?e.jsx("div",{children:"Loading dashboard..."}):h?e.jsx("div",{className:"error-message",children:h}):e.jsxs("div",{children:[e.jsxs("h1",{children:["Welcome, ",(s==null?void 0:s.first_name)||(a==null?void 0:a.email),"!"]}),e.jsx("p",{children:"Here's a quick overview of your teaching activities."}),e.jsxs("div",{className:"dashboard-grid",children:[e.jsxs("div",{className:"dashboard-card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx(y,{size:24}),e.jsx("h2",{children:"Total Students"})]}),e.jsx("p",{className:"card-main-stat",children:x}),e.jsx(n,{to:"/teacher-panel/my-students",className:"btn btn-small",children:"Manage Students"})]}),e.jsxs("div",{className:"dashboard-card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx(S,{size:24}),e.jsx("h2",{children:"Total Courses"})]}),e.jsx("p",{className:"card-main-stat",children:"0"})," ",e.jsx(n,{to:"/teacher-panel/my-courses",className:"btn btn-small",children:"Manage Courses"})]}),e.jsxs("div",{className:"dashboard-card wide-card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{children:"Recently Added Students"})}),l.length>0?e.jsx("ul",{className:"recent-list",children:l.map(t=>e.jsxs("li",{children:[e.jsxs("span",{children:[t.first_name," ",t.last_name]}),e.jsx(n,{to:`/teacher-panel/my-students/${t.id}`,className:"btn btn-small btn-secondary",children:"View"})]},t.id))}):e.jsx("p",{children:"No students have been added yet."})]})]}),e.jsxs("div",{className:"dashboard-section",children:[e.jsx("h2",{children:"Quick Actions"}),e.jsxs("div",{className:"quick-actions-container",children:[e.jsxs(n,{to:"/teacher-panel/my-students",className:"action-card",children:[e.jsx(u,{size:32}),e.jsx("span",{children:"Add New Student"})]}),e.jsxs(n,{to:"/teacher-panel/my-courses",className:"action-card",children:[e.jsx(u,{size:32}),e.jsx("span",{children:"Create New Course"})]})]})]})]})};export{k as default};
